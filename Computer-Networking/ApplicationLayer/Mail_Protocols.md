# Mail Protocols
----------------

邮件系统是由三个主要部分组成的：**用户代理**，**邮件服务器**以及**简单邮件传输协议**。用户在本地使用用户代理对邮件进行操作（撰写，删除，查阅等），在发邮件的时候，用户代理把用户撰写好的邮件发送到邮件服务器，并且该邮件被放在了邮件服务器的发送报文队列中去。当用户想读取邮件的时候，其用户代理从邮件服务器上把邮件获取下来。每个接收方在某个邮件服务器上都有一个自己的邮箱。

SMTP用来将邮件从发送方的邮件服务器传输到接收方的邮件服务器；STMP也可以用来将邮件从发送方的用户代理传送到接收方的邮件服务器。而MIME则是STMO的一个扩展。至于邮件访问协议，是用来将邮件从接收方的邮件服务器传送到接收方的用户代理的，这些邮件访问协议有：POP3，IMAP等。

## SMTP工作过程

1. A用户调用他的邮件代理程序并提供B的邮件地址，撰写邮件，并且通过用户代理发送该邮件。
2. A的用户代理把报文发给了A用户坐在地的邮件服务器，该报文被放在那里的发送报文队列中。
3. 运行在A的邮件服务器上的STMP客户机发现了这个报文，它就创建一个到运行在B的邮件服务器上运行的STMP服务器的TCP连接。
4. 经过一些TCP握手之后，SMTP客户机开始向该TCP连接发送A的报文。
5. 在B的邮件服务器上，SMTP的服务器收到了该报文，B的邮件服务器然后将该报文放到B的邮箱中。
6. 在B方便的时候，他就可以从邮箱中读到A发给他的邮件了。

STMP于HTTP有一定的差异：STMP是一个**推协议**，即发送邮件服务器把邮件推向接受邮件服务器，特别是，这个TCP连接是由发送文件的机器发起的。HTTP是一个**拉协议**，即人们可以在方便的时候装载Web服务器上的信息，也就是说，用户用HTTP从该服务器拉取信息。特别是，TCP是由想拉取文件的机器发出的。

## MIME与STMP

由于STMP只允许报文段为7位的ASCII码字符，这样严重限制了报文段的内容，MIME是多用途因特网邮件扩展，允许多媒体报文的传输，这是通过在报文的首部行包含Content-Type以及Content-Tramsfer-Encoding来对报文内容及其压缩方式（编码方式）进行描述的。

## POP3与IMAP

POP3并没有为用户提供任何创建远程文件夹以及为报文指派文件夹的方法。它的工作仅分为三个步骤：用户认证，事务处理以及更新。而事务处理的形式也是有限的，它只提供了给邮件做删除标记，取消删除标记以及获取邮件统计信息三个操作。但IMAP提供了远程文件夹的功能，允许用户创建文件夹，移动邮件，阅读邮件，删除邮件等。

## 基于Web的电子邮件

基于Web的电子邮件的用户代理就是简单的浏览器，从浏览器到邮件服务器的通信使用的是HTTP协议，但从源到目的地的邮件报文发送还是通过STMP协议实现的。
