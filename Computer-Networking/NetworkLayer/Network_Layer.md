# Network Layer
---------------


## 网络层概述

网络层中的每一台主机和路由器中有一个网络层部分。网络层分组交付有两种方式，一种是数据报模式，另一种是虚电路模式。路由器的作用是将数据报从入链路转发到出链路。


## 虚电路与数据报

网络层的连接和无连接服务在很多方面等同于运输层的面向连接和无连接服务。仅在网络层提供连接服务的计算机网络被称为**虚电路网络**，仅在网络层提供无连接服务的计算机网络被称为**数据报网络**。

### 虚电路网络

一个虚电路的组成如下：

1. 源和目的主机之间的路径（即一系列链路和路由器）。
2. VC号，沿着该路经的每段链路一个号码。
3. 沿着该路径的每台路由器中的转发表项。

当数据报沿着虚电路中的路径传输的时候，在每一条链路中，数据报所携带的VC号都是不一样的，这样有两个好处：首先可以减少分组首部中的VC字段的长度，再者，这样做大大简化了虚电路的建立。如果数据报在整个虚电路上的VC号是一致的，那么在虚电路建立的时候所有路由器就得进行协商该使用什么VC号，这样做无疑加大了网络负担，也使得效率降低。

虚电路网络所提供的连接服务跟运输层提供的连接服务有着本质的区别，在运输层建立的连接服务是由两个端系统独立决定参数的，而在虚电路建立连接的时候，所有路由器都必须参与到路径的建立当中。并且每当建立一个连接，该链接上的所有路由器的转发表都要添加一个表项。

在端系统向网络发送指示虚电路启动与终止的报文，以及路由器之间传递用于建立虚电路的报文被称为**信令报文**，用来交换这些报文的协议称为**信令协议**。


### 数据报网络

在数据报网络中，每当一个端系统要发送分组的时候，它就为该分组加上目的地端系统的地址，然后将该分组推进网络中。每台路由器有一个将目的地址映射到链路接口的转发表，当分组到达路由器时，该路由器使用该分组的目的地址在该转发表中查找适当的输出链路接口。
