# Router
--------


## 路由器概述

路由器主要承担网络层中的转发功能，即将分组从一条输入链路转发到输出链路，充当的是立交桥的作用。其主要有四个结构：

+ **输入端口** 输入端口主要用于将物理链路端的数据街道路由器的物理层功能，它也要执行需要与位于入链路远端的数据链路层功能交互的数据链路层功能。它还要完成**查找**与**转发**的功能。

+ **交换结构** 交换结构将路由器的输入端口连接到它的输出端口。

+ **输出端口** 输出端口存储经过交换结构转发给它的分组，并将这些分组传输到输出链路，其实输出端口执行着与输入端口顺序相反的数据链路层和物理层功能。

+ **选路处理器** 它执行选路协议，维护选路信息与转发表，并执行路由器的网络管理功能。


### 输入端口

在很多路由器中，都是在输入端口确定一个到达的分组经交换结构转发给哪个输出端口的。虽然转发表是选路处理器进行计算的，但为了提高效率，在每个输入端口都会有一个转发表的拷贝，这样就可以在分组传入的时候做出决策，而不需要调用中央选路处理器。

输入端口的一个关键问题是查转发表的问题。一种简单的转发表结构是二叉树结构，这其实等于一种变相的二分查找，这样对于地址为N的分组，在N步之内必定能找到对应的表项。一旦确定了输出端口，就可以送去交换结构了。但分组有可能会在进入之前被阻塞，因为交换结构可能正处于忙碌状态。

### 交换结构

交换结构可以通过多种方式实现：

+ 内存式
+ 纵横式
+ 总线式

### 输出端口

输出端口用于缓存经交换结构送出的分组，并且对准备送出的数据进行数据链路层的封装。
