# DHCP
-------

DHCP是一个客户机/服务器协议。主要目的在于帮子网的主机动态分配IP地址。当主机加入或离开时，DHCP服务器要更新其可用的IP地址表，每当一台主机加入的时候，DHCP服务器从其当前可用的地址池中分配一个任意的地址给它，每当一台主机离开时，其地址便被收回池中。


## DHCP协议的步骤：

1. **DHCP服务器发现** 新到达的主机的首要任务是发现一个要与其交互的DHCP服务器。这通过**DHCP发现报文**来完成。由于一开始主机并不知道DHCP服务器的IP地址，所以主机使用一个源地址为`0.0.0.0`以及目的地址为`255.255.255.255`的`DHCP DISCOVER MESSAGE`进行广播。

2. **DHCP服务器提供** DHCP服务器收到发现报文之后，用一个`DHCP OFFER MESSAGE`报文进行相应，并在其中提供了可用的IP地址，网络掩码以及租用期。这时候DHCP的提供报文也是使用广播的，因为在子网中，有可能有_不止一台_的DHCP服务器，这样用户主机还是可以进行选择的，所以DHCP服务器要进行广播。

3. **DHCP请求** 新到达的客户机从收到的DHCP提供报文中选择一个，并发送`DHCP REQUEST MESSAGE`对选中的DHCP服务器进行请求。

4. **DHCP确认** DHCP服务器收到用户的DHCP请求以后，发送`DHCP ACK`进行确认，至此，新到达的用户机就具有DHCP为其动态分配的IP地址了。
