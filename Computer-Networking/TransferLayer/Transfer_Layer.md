# Transfer Layer Generals
-------------------------


## 运输层与网络层的关系

运输层协议为运行在不同主机上的应用程序之间提供了逻辑通信功能，从应用程序的角度看，通过**逻辑通信**，运行在不同进程的主机好像直接相连一样。**运输层为运行在不同主机上的进程之间提供了逻辑通信，而网络层则提供了主机之间的逻辑通信**。运输层只工作在端系统。

UDP和TCP最基本的任务是，将两个端系统之间IP的交付服务扩展为运行在两个端系统上的进程之间的交付服务。_将主机间交付扩展到进程间交付，称为**运输层的多路复用于多路分解**。_ UDP只提供进程间数据交付以及差错检验两种功能。TCP除了提供这两种功能以外，还提供**可靠数据传输**以及**拥塞控制**的功能。


## 多路分解与多路复用

将运输层报文段中的数据交付到正确的套接字的工作称为**多路分解**。从源主机的不同套接字中收集数据块，并为每个数据块封装上首部信息从而生成报文段，然后将报文传递到网络层的工作称为**多路复用**。

### 无连接

无连接多路分解的实现是这样的：主机上的每个套接字被分配了一个端口号，当报文段到达主机的时候，运输层检查报文段中的目的端口号，并将其定向到相应的套接字上。然后报文段中的数据通过套接字进入其所连接的进程。**一个UDP套接字是由一个包含目的IP地址和目的端口号的二元组来全面标识的**。

### 面向连接

**TCP套接字是由一个四元组（源IP地址，源端口号，目的IP地址，目的端口号）来标识的**。可以从这个地方看出TCP与UDP之间的差别，由于UDP套接字并没有记录源的端口号和IP地址，那么在报文段传到目的地之后，目的主机并不能根据报文段推测源的任何信息，这样就无从与源建立任何的连接。所以UDP被称为无连接。而TCP的报文段包含了源的端口号和目的地，这样就为目的主机于源主机提供了相互连接，相互通信的基础。
